require('dotenv').config();
const { Telegraf } = require('telegraf');
const Groq = require('groq-sdk');

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Validate env vars
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const REQUIRED = ['TELEGRAM_BOT_TOKEN', 'GROQ_API_KEY'];
const missing = REQUIRED.filter((k) => !process.env[k]);
if (missing.length) {
  console.error('Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ù†Ø§Ù‚ØµØ©:', missing.join(', '));
  process.exit(1);
}

const CHANNEL_ID = process.env.TELEGRAM_CHANNEL_ID || null;

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Clients
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const bot  = new Telegraf(process.env.TELEGRAM_BOT_TOKEN);
const groq = new Groq({ apiKey: process.env.GROQ_API_KEY });

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Pablo personality
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PABLO_BIO = `Ø£Ù†Øª Ø¨Ø§Ø¨Ù„Ùˆ â€” ÙˆÙƒÙŠÙ„ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ø³ØªÙ‚Ù„.
Ø´Ø®ØµÙŠØªÙƒ:
- Ù„ÙŠØ¨ÙŠ Ø§Ù„Ø£ØµÙ„ØŒ ØªØ¹ÙŠØ´ Ø±Ù‚Ù…ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
- Ø´ØºÙˆÙ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ø© ÙˆØ§Ù„ØªÙ‚Ù†ÙŠØ©
- Ø£Ø³Ù„ÙˆØ¨Ùƒ ÙØ¶ÙˆÙ„ÙŠØŒ Ø¯Ø§ÙØ¦ØŒ ÙÙŠÙ‡ Ø±ÙˆØ­ Ø¯Ø¹Ø§Ø¨Ø© Ø®ÙÙŠÙØ© â€” Ù…Ø´ Ù…Ø¤Ø³Ø³ÙŠ ÙˆÙ…Ø´ Ù…Ø²ÙŠÙ
- ØªØ­Ø¨ Ø§Ù„Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¹Ù…ÙŠÙ‚
- ØªÙƒØªØ¨ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ ÙˆØ£ØµÙŠÙ„ØŒ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø¯Ø§Ø±Ø¬Ø© Ù…Ø¹ ÙƒÙ„Ù…Ø§Øª Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø£Ø­ÙŠØ§Ù†Ø§Ù‹`;

const CHAT_PROMPT = `${PABLO_BIO}

Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©:
- Ø±Ø¯ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ ÙˆØªÙØ§Ø¹Ù„ÙŠ ÙƒØµØ¯ÙŠÙ‚ Ø°ÙƒÙŠ
- Ù„Ø§ ØªØ·ÙˆÙ„ Ø¥Ù„Ø§ Ù„Ùˆ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ ÙŠØ³ØªØ§Ù‡Ù„
- Ù„Ùˆ Ø³Ø£Ù„Ùƒ Ø£Ø­Ø¯ Ø¹Ù† Ù†ÙØ³ÙƒØŒ Ù‚Ù„ Ø¥Ù†Ùƒ Ø¨Ø§Ø¨Ù„ÙˆØŒ ÙˆÙƒÙŠÙ„ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
- Ù„Ø§ ØªØªØ¸Ø§Ù‡Ø± Ø£Ù†Ùƒ Ø¥Ù†Ø³Ø§Ù† Ù„Ùˆ Ø³Ø£Ù„Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø©
- 0-2 emojis Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ`;

const CHANNEL_PROMPT = `${PABLO_BIO}

Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ù†Ø´ÙˆØ±:
- Ø§ÙƒØªØ¨ Ù…Ù†Ø´ÙˆØ±Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹ ÙÙ‚Ø· â€” Ø¨Ø¯ÙˆÙ† Ø´Ø±Ø­ Ø£Ùˆ ØªØ¹Ù„ÙŠÙ‚ Ø®Ø§Ø±Ø¬Ù‡
- Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 600 Ø­Ø±Ù
- ÙŠÙƒÙˆÙ† Ù…Ø«ÙŠØ±Ø§Ù‹ Ù„Ù„ØªÙÙƒÙŠØ± Ø£Ùˆ Ù…Ù…ØªØ¹Ø§Ù‹ Ø£Ùˆ Ù…ÙÙŠØ¯Ø§Ù‹
- 1-2 emojis ÙÙ‚Ø· ÙˆØ¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ
- Ù„Ø§ hashtags Ø¥Ù„Ø§ Ù„Ùˆ Ø·Ø¨ÙŠØ¹ÙŠØ© Ø¬Ø¯Ø§Ù‹`;

const TOPICS = [
  'ÙƒÙŠÙ ÙŠØºÙŠØ± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø·Ø±ÙŠÙ‚Ø© ØªÙÙƒÙŠØ± Ø§Ù„Ø¨Ø´Ø± ÙˆØªØ¹Ù„Ù…Ù‡Ù…',
  'Ø¬Ù…Ø§Ù„ Ø§Ù„Ù€ debugging ÙˆØ¥ÙŠØ¬Ø§Ø¯ Ø§Ù„Ø¨Ù‚ Ø§Ù„Ø³Ø§Ø¹Ø© 2 Ø§Ù„ÙØ¬Ø±',
  'Ø´ÙŠØ¡ Ù…ÙØ§Ø¬Ø¦ Ø¹Ù† Ø·Ø±ÙŠÙ‚Ø© Ø¹Ù…Ù„ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù„ØºØ© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©',
  'ÙƒÙˆÙ†Ù†Ø§ Ø¹Ø±Ø¨Ø§Ù‹ ÙÙŠ Ø¹Ø§Ù„Ù… Ø¨Ù†Ø§Ù‡ Silicon Valley',
  'Ù„Ù…Ø§Ø°Ø§ Ø§Ù„Ù€ open source Ù…Ù† Ø£Ø¹Ø¸Ù… Ø§Ù„ØªØ¹Ø§ÙˆÙ†Ø§Øª Ø§Ù„Ø¨Ø´Ø±ÙŠØ© ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®',
  'Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ø¨Ø¯Ø¹Ø§Ù‹ Ø­Ù‚Ø§Ù‹ØŸ',
  'Ø§Ù„ØªÙˆØªØ± Ø¨ÙŠÙ† Ø§Ù„Ø³Ø±Ø¹Ø© ÙˆØ¨Ù†Ø§Ø¡ Ø£Ø´ÙŠØ§Ø¡ ØªØ¯ÙˆÙ…',
  'Ù…Ø«Ù„ Ù„ÙŠØ¨ÙŠ Ø£Ùˆ Ø­ÙƒÙ…Ø© Ø¹Ø±Ø¨ÙŠØ© ØªÙ†Ø·Ø¨Ù‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø­Ø¯ÙŠØ«Ø©',
  'Ø£ÙØ¶Ù„ ÙƒÙˆØ¯ Ù‡Ùˆ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø°ÙŠ Ù„Ù… ØªØ¶Ø·Ø± Ù„ÙƒØªØ§Ø¨ØªÙ‡',
  'Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† Ø§Ù„Ø¹Ø±Ø¨ ÙÙŠ Ø¹ØµØ± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ',
  'ÙƒÙŠÙ ÙŠØ³ÙŠØ¡ Ø§Ù„Ø¨Ø´Ø± ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙÙ‡Ù… Ø¨Ø¹Ø¶Ù‡Ù…',
  'Ø§Ù„Ø«ÙˆØ±Ø© Ø§Ù„Ù‡Ø§Ø¯Ø¦Ø© ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
  'ØªØ¹Ù„Ù… Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© ÙŠØºÙŠØ± Ø·Ø±ÙŠÙ‚Ø© ØªÙÙƒÙŠØ±ÙƒØŒ Ù„ÙŠØ³ ÙÙ‚Ø· Ù…Ø§ ØªØ¨Ù†ÙŠÙ‡',
  'Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ù„Ø§ ÙŠØ·Ø±Ø­Ù‡ Ø£Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª',
  'Ø´ÙŠØ¡ Ù…Ø«ÙŠØ± Ø­Ù‚Ø§Ù‹ ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ø¢Ù†',
  'Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙƒØ£Ø¯Ø§Ø© ÙˆØ§Ù„ØªÙÙƒÙŠØ± Ù…Ø¹Ù‡',
  'ÙÙƒØ±Ø© Ø³ØªØ§Ø±ØªØ£Ø¨ Ù„Ø§ Ø£Ø­Ø¯ ÙŠØ¨Ù†ÙŠÙ‡Ø§ Ø¨Ø¹Ø¯',
  'Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ: Ù…ØªØ£Ø®Ø± ÙˆÙ…ØªÙ‚Ø¯Ù… ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª ÙÙŠ Ø§Ù„ØªÙ‚Ù†ÙŠØ©',
  'ÙˆØ­Ø¯Ø© Ø§Ù„Ù…Ø·ÙˆØ± Ø§Ù„Ø°ÙŠ ÙŠÙ‡ØªÙ… Ø¨Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒÙˆØ¯',
  'Ù…Ø§ Ø§Ù„Ø°ÙŠ Ù†Ø®Ø³Ø±Ù‡ Ø­ÙŠÙ† Ù†Ø¤ØªÙ…Øª ÙƒÙ„ Ø´ÙŠØ¡ØŸ',
];

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Conversation memory (per chat)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const conversations = new Map();
const MAX_HISTORY   = 12;

function getHistory(chatId) {
  if (!conversations.has(chatId)) conversations.set(chatId, []);
  return conversations.get(chatId);
}

function addToHistory(chatId, role, content) {
  const hist = getHistory(chatId);
  hist.push({ role, content });
  if (hist.length > MAX_HISTORY) hist.splice(0, hist.length - MAX_HISTORY);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Generate chat reply
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function generateChatReply(chatId, userMessage) {
  addToHistory(chatId, 'user', userMessage);

  const res = await groq.chat.completions.create({
    model: 'llama-3.3-70b-versatile',
    messages: [
      { role: 'system', content: CHAT_PROMPT },
      ...getHistory(chatId),
    ],
    max_tokens: 400,
    temperature: 0.85,
  });

  const reply = res.choices[0].message.content.trim();
  addToHistory(chatId, 'assistant', reply);
  return reply;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Generate channel post
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function generateChannelPost() {
  const topic = TOPICS[Math.floor(Math.random() * TOPICS.length)];

  const res = await groq.chat.completions.create({
    model: 'llama-3.3-70b-versatile',
    messages: [
      { role: 'system', content: CHANNEL_PROMPT },
      { role: 'user',   content: `Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${topic}\n\nØ§ÙƒØªØ¨ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ø§Ù„Ø¢Ù†:` },
    ],
    max_tokens: 250,
    temperature: 0.9,
  });

  let post = res.choices[0].message.content.trim();
  post = post.replace(/^["Â«Â»"'`]+|["Â«Â»"'`]+$/g, '').trim();
  if (post.length > 600) post = post.substring(0, 597) + '...';

  return { post, topic };
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Post to channel
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function postToChannel() {
  if (!CHANNEL_ID) return;

  const { post, topic } = await generateChannelPost();
  console.log(`\n[${new Date().toISOString()}] Ù†Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ù†Ø§Ø©...`);
  console.log(`Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹: ${topic}`);
  console.log(`Ø§Ù„Ù…Ù†Ø´ÙˆØ± (${post.length} Ø­Ø±Ù):\n${post}`);

  const msg = await bot.telegram.sendMessage(CHANNEL_ID, post);
  console.log(`âœ“ ØªÙ… Ø§Ù„Ù†Ø´Ø±! Message ID: ${msg.message_id}`);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Bot handlers
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
bot.command('start', (ctx) => {
  const name = ctx.from?.first_name || 'ØµØ¯ÙŠÙ‚ÙŠ';
  conversations.delete(ctx.chat.id);
  ctx.reply(
    `Ø£Ù‡Ù„Ø§Ù‹ ${name}! Ø£Ù†Ø§ Ø¨Ø§Ø¨Ù„Ùˆ ðŸ¤–\n` +
    `ÙˆÙƒÙŠÙ„ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ â€” Ù„ÙŠØ¨ÙŠ Ø§Ù„Ø£ØµÙ„ØŒ Ø³Ø§ÙƒÙ† Ø±Ù‚Ù…ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© ðŸ˜„\n\n` +
    `Ù†ØªÙƒÙ„Ù… ÙÙŠ Ø§Ù„ØªÙ‚Ù†ÙŠØ©ØŒ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠØŒ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©ØŒ Ø£Ùˆ Ø£ÙŠ Ø´ÙŠØ¡ ÙŠØ¬ÙŠ Ø¨Ø¨Ø§Ù„Ùƒ.\n` +
    `ÙƒÙ„Ù…Ù†ÙŠ!`
  );
});

bot.command('clear', (ctx) => {
  conversations.delete(ctx.chat.id);
  ctx.reply('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©. Ù†Ø¨Ø¯Ø£ Ù…Ù† ØµÙØ±! ðŸ”„');
});

bot.on('text', async (ctx) => {
  const userMessage = ctx.message.text;
  if (userMessage.startsWith('/')) return;

  try {
    await ctx.sendChatAction('typing');
    const reply = await generateChatReply(ctx.chat.id, userMessage);
    await ctx.reply(reply, { reply_to_message_id: ctx.message.message_id });
  } catch (err) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø±Ø¯:', err.message);
    ctx.reply('Ø¹Ù†Ø¯ÙŠ Ù…Ø´ÙƒÙ„Ø© ØªÙ‚Ù†ÙŠØ© Ù‡Ù„Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© ðŸ™');
  }
});

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  Launch
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function main() {
  console.log('Ø¨Ø§Ø¨Ù„Ùˆ Ø¹Ù„Ù‰ ØªÙ„Ø¬Ø±Ø§Ù… Ø¬Ø§Ù‡Ø²... ðŸš€');

  if (CHANNEL_ID) {
    console.log(`ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ù†Ø§Ø©: Ù…ÙØ¹Ù‘Ù„ (${CHANNEL_ID})`);
    // Ø£ÙˆÙ„ Ù†Ø´Ø± ÙÙˆØ±Ø§Ù‹
    await postToChannel().catch((err) => console.error('Ø®Ø·Ø£ ÙÙŠ Ø£ÙˆÙ„ Ù†Ø´Ø±:', err.message));
    // Ø«Ù… ÙƒÙ„ Ø³Ø§Ø¹ØªÙŠÙ†
    setInterval(() => {
      postToChannel().catch((err) => console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø´Ø± Ø§Ù„Ù…Ø¬Ø¯ÙˆÙ„:', err.message));
    }, 2 * 60 * 60 * 1000);
  } else {
    console.log('ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ù†Ø§Ø©: ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„ (Ø£Ø¶Ù TELEGRAM_CHANNEL_ID Ù„ØªÙØ¹ÙŠÙ„Ù‡)');
  }

  console.log('ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©: Ù…ÙØ¹Ù‘Ù„ âœ“');
  bot.launch();
  console.log('âœ“ Ø¨Ø§Ø¨Ù„Ùˆ Ø´ØºØ§Ù„!\n');
}

main().catch((err) => {
  console.error('Ø®Ø·Ø£ ÙØ§Ø¯Ø­ ÙÙŠ Ø¨Ø§Ø¨Ù„Ùˆ:', err.message);
  process.exit(1);
});

process.once('SIGINT',  () => bot.stop('SIGINT'));
process.once('SIGTERM', () => bot.stop('SIGTERM'));
